var startTime=void 0,preloader=void 0;$(window).load(function(){$(".noscroll").each(function(){$(this).removeClass("noscroll")});var e=$("#preload");new Date-startTime>=500?(e.find("h1").text("Done!"),setTimeout(function(){e.addClass("gone"),setTimeout(function(){e.css("display","none")},750)},1e3)):(clearTimeout(preloader),e.css("display","none"))}),$(document).ready(function(){startTime=new Date,preloader=setTimeout(function(){$("#preload").css("background-color","#333")},500);var e=$(window),o=e.height(),t=e.width(),n=new ScrollMagic.Controller,i=$("#slider"),a=Math.max(o/2848,t/4288),r=new TimelineLite({paused:!0}).to(i,1,{css:{zoom:a},ease:Linear.easeNone,force3D:!0}).to($("#title"),.1,{css:{autoAlpha:"0"},ease:Linear.easeNone},0).to($("#start"),1,{css:{autoAlpha:"0",display:"none"}},0).to(i,.5,{autoAlpha:"0",ease:Linear.easeNone,force3D:!0}).set(i,{css:{display:"none"}});e.on("scroll",function(){var t=e.scrollTop()/o;t>=0&&(r.progress()<1||1.5>=t)&&TweenLite.to(r.pause(),.1,{time:t})}),new ScrollMagic.Scene({offset:o,duration:2*o}).setTween((new TimelineLite).to($("#bg1"),1,{css:{top:"-18%"},ease:Linear.easeNone})).addTo(n),new ScrollMagic.Scene({triggerElement:"#section3",triggerHook:"onLeave",duration:o}).setTween((new TimelineLite).to($("#colorslider"),1,{css:{top:"-=100%"},ease:Linear.easeNone})).addTo(n);var s={discard:[["Monitors",595],["Computers",423],["Hard Drives",290],["Computer Peripherals",67],["Mobile Devices",19]],create:[["Computers",40],["Monitors",33],["Hard Drives",33],["Peripherals",10],["Mobile Devices",11]],countries:{names:["USA","EU Nations","China","India","Japan","Russia"],values:[10.3,10.9,8,3,3,1.6]}},c=void 0,l=void 0;new ScrollMagic.Scene({triggerElement:"#pin",triggerHook:"onCenter",duration:0}).on("enter",function(){c=c||new Highcharts.Chart({chart:{type:"pie",renderTo:"chart"},title:{text:"Waste",align:"center",verticalAlign:"middle"},plotOptions:{pie:{shadow:!1,center:["50%","50%"]}},tooltip:{valueSuffix:"k"},series:[{type:"pie",name:"Tons Discarded",innerSize:"30%",data:JSON.parse(JSON.stringify(s.discard))}]})}).addTo(n),new ScrollMagic.Scene({triggerElement:"#pin",triggerHook:"onLeave",duration:o}).setPin("#pin").addTo(n),new ScrollMagic.Scene({triggerElement:"#section2",duration:0}).on("enter",function(){$.each(c.series[0].data,function(e,o){o.update(s.create[e],!1)}),c.series[0].tooltipOptions.valueSuffix="%",c.series[0].name="Percentage Recycled",c.redraw()}).on("leave",function(){$.each(c.series[0].data,function(e,o){o.update(s.discard[e],!1)}),c.series[0].tooltipOptions.valueSuffix="k",c.series[0].name="Tons Discarded",c.redraw()}).addTo(n),new ScrollMagic.Scene({triggerElement:"#section3",triggerHook:"onCenter",duration:0}).on("enter",function(){l=l||new Highcharts.Chart({chart:{type:"bar",renderTo:"barchart"},title:{text:"E-Waste Production by Country"},tooltip:{valueSuffix:" million"},xAxis:{categories:s.countries.names},yAxis:{min:0,title:{text:"Discards (Million Tons)",align:"high"}},plotOptions:{bar:{dataLabels:{enabled:!0}}},series:[{name:"Top Countries",data:s.countries.values}]}),$("#section3").find(".left").addClass("active")}).addTo(n),new ScrollMagic.Scene({triggerElement:"#smog",triggerHook:"onEnter",duration:o}).setTween("#bg3",{css:{autoAlpha:1}}).addTo(n),new ScrollMagic.Scene({triggerElement:"#bg3-container",triggerHook:"onLeave",duration:4*o}).setTween("#bg3",{css:{top:"-100%"},ease:Linear.easeNone}).setPin("#bg3-container").addTo(n),new ScrollMagic.Scene({triggerElement:"#smog",triggerHook:"onCenter",duration:0}).setTween("#smog-image",1,{css:{autoAlpha:1},ease:Linear.easeNone}).addTo(n);var d=$("#cellphone");d.on("load",function(){d.css("left",-d.width()/3+"px"),$(".phone-padding").css("margin-left",2*d.width()/3+"px").css("max-width",t-2*d.width()/3)});var g=(new TimelineLite).fromTo(d,1,{top:"0"},{top:"-100%",ease:Linear.easeNone});new ScrollMagic.Scene({triggerElement:"#case",triggerHook:"onCenter",duration:2*o}).setTween(g).setPin("#case").addTo(n),new ScrollMagic.Scene({triggerElement:"#health",triggerHook:"onLeave",offset:o/2}).setTween((new TimelineLite).fromTo("#pirate",.5,{css:{zoom:2,autoAlpha:0}},{css:{zoom:1,autoAlpha:1}}).fromTo($("#pirate div"),.5,{css:{display:"block",autoAlpha:0}},{css:{autoAlpha:1}})).addTo(n)});